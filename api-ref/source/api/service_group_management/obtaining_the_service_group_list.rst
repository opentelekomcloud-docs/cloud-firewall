:original_name: ListServiceSets.html

.. _ListServiceSets:

Obtaining the Service Group List
================================

Function
--------

This API is used to obtain the service group list.

URI
---

GET /v1/{project_id}/service-sets

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                                                                            |
   +============+===========+========+========================================================================================================================================+
   | project_id | Yes       | String | Project ID, which can be obtained by calling an API or from the console. For details, see :ref:`Obtaining a Project ID <cfw_02_0015>`. |
   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter              | Mandatory | Type    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   +========================+===========+=========+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | object_id              | Yes       | String  | Protected object ID, which is used to distinguish between Internet border protection and VPC border protection after a cloud firewall is created. You can obtain the ID by calling the :ref:`API for querying firewall instances <listfirewalldetail>`. In the return value, find the ID in **data.records.protect_objects.object_id** (The period [.] is used to separate different levels of objects). If the value of **type** is **0**, the protected object ID belongs to the Internet border. If the value of **type** is **1**, the protected object ID belongs to the VPC border. You can obtain the value of **type** from **data.records.protect_objects.type** (The period [.] is used to separate different levels of objects). |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | key_word               | No        | String  | Keyword, which can be the service group name or part of the service group description.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit                  | Yes       | Integer | Number of query records on each page. The value ranges from 1 to 1024.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | offset                 | Yes       | Integer | Offset, which specifies the start position of the record to be returned. The value must be a number no less than 0. The default value is **0**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id  | No        | String  | Enterprise project ID, which is the ID of a project planned based on organizations. You can obtain the enterprise project ID by referring to :ref:`Obtaining an Enterprise Project ID <cfw_02_0027>`. If the enterprise project function is not enabled, the value is **0**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | fw_instance_id         | No        | String  | Firewall ID, which can be obtained by referring to :ref:`Obtaining a Firewall ID <cfw_02_0028>`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | query_service_set_type | No        | Integer | Type of the service group to be queried: **0** (user-defined service group), **1** (predefined service group).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   +------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                       |
   +==============+===========+========+===================================================================================================+
   | X-Auth-Token | Yes       | String | User token. You can obtain the token by referring to :ref:`Obtaining a User Token <cfw_02_0029>`. |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+
   | Content-Type | Yes       | String | Content type. It can only be set to application/json.                                             |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------+-------------------------------------------------------------------------------+-------------------------------+
   | Parameter | Type                                                                          | Description                   |
   +===========+===============================================================================+===============================+
   | data      | :ref:`ServiceSetRecords <listservicesets__response_servicesetrecords>` object | Query the service group list. |
   +-----------+-------------------------------------------------------------------------------+-------------------------------+

.. _listservicesets__response_servicesetrecords:

.. table:: **Table 5** ServiceSetRecords

   +-----------+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Type                                                                      | Description                                                                                                                                     |
   +===========+===========================================================================+=================================================================================================================================================+
   | offset    | Integer                                                                   | Offset, which specifies the start position of the record to be returned. The value must be a number no less than 0. The default value is **0**. |
   +-----------+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit     | Integer                                                                   | Number of records displayed on each page. The value ranges from 1 to 1024.                                                                      |
   +-----------+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
   | total     | Integer                                                                   | Query the total number of service groups.                                                                                                       |
   +-----------+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
   | records   | Array of :ref:`ServiceSet <listservicesets__response_serviceset>` objects | Service group list.                                                                                                                             |
   +-----------+---------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listservicesets__response_serviceset:

.. table:: **Table 6** ServiceSet

   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Type              | Description                                                                                                                                                              |
   +==================+===================+==========================================================================================================================================================================+
   | set_id           | String            | Service group ID.                                                                                                                                                        |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name             | String            | Service group name.                                                                                                                                                      |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description      | String            | Service group description.                                                                                                                                               |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | service_set_type | Integer           | Service group type: **0** (user-defined service group), **1** (common web service), **2** (common remote login and ping), or **3** (common database).                    |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ref_count        | Integer           | Number of times a service group is referenced by rules.                                                                                                                  |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | project_id       | String            | Project ID.                                                                                                                                                              |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protocols        | Array of integers | Protocol list. Protocol type: **6** (TCP), **17** (UDP), **1** (ICMP), **58** (ICMPv6), or **-1** (any). It cannot be left blank when **type** is set to **0** (manual). |
   +------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 7** Response body parameters

   ========== ====== ==================
   Parameter  Type   Description
   ========== ====== ==================
   error_code String Error code.
   error_msg  String Error description.
   ========== ====== ==================

Example Requests
----------------

Query the service group list on the first page of protected object a37bb4eb-c49e-4e88-bf77-944a75b0ce8a in project 2349ba469daf4b7daf268bb0261d18b0.

.. code-block::

   https://{Endpoint}/v1/2349ba469daf4b7daf268bb0261d18b0/service-sets?object_id=a37bb4eb-c49e-4e88-bf77-944a75b0ce8a&limit=10&offset=0

Example Responses
-----------------

**Status code: 200**

Return value for the service group list query.

.. code-block::

   {
     "data" : {
       "limit" : 50,
       "offset" : 0,
       "records" : [ {
         "name" : "test",
         "project_id" : "2349ba469daf4b7daf268bb0261d18b0",
         "protocols" : [ 6 ],
         "ref_count" : 2,
         "service_set_type" : 0,
         "set_id" : "6f475bad-5d33-45d1-98f8-c79f2f308d5a"
       } ],
       "total" : 1
     }
   }

**Status code: 400**

Bad Request

.. code-block::

   {
     "error_code" : "CFW.0020016",
     "error_msg" : "Incorrect instance status."
   }

Status Codes
------------

=========== ==============================================
Status Code Description
=========== ==============================================
200         Return value for the service group list query.
400         Bad Request
401         Unauthorized
403         Forbidden
404         Not Found
500         Internal Server Error
=========== ==============================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
