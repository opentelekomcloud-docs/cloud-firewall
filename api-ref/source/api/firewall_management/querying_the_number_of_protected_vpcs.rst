:original_name: ListProtectedVpcs.html

.. _ListProtectedVpcs:

Querying the Number of Protected VPCs
=====================================

Function
--------

This API is used to query information about protected VPCs.

URI
---

GET /v1/{project_id}/vpcs/protection

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                                                                            |
   +============+===========+========+========================================================================================================================================+
   | project_id | Yes       | String | Project ID, which can be obtained by calling an API or from the console. For details, see :ref:`Obtaining a Project ID <cfw_02_0015>`. |
   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +-----------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory | Type   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   +=======================+===========+========+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | object_id             | Yes       | String | Protected object ID, which is used to distinguish between Internet border protection and VPC border protection after a cloud firewall is created. You can obtain the ID by calling the :ref:`API for querying firewall instances <listfirewalldetail>`. In the return value, find the ID in **data.records.protect_objects.object_id** (The period [.] is used to separate different levels of objects). If the value of **type** is **0**, the protected object ID belongs to the Internet border. If the value of **type** is **1**, the protected object ID belongs to the VPC border. Here, a protected object ID whose **type** is **1** is used. You can obtain the value of **type** from **data.records.protect_objects.type** (The period [.] is used to separate different levels of objects). |
   +-----------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id | No        | String | Enterprise project ID, which is the ID of a project planned based on organizations. You can obtain the enterprise project ID by referring to :ref:`Obtaining an Enterprise Project ID <cfw_02_0027>`. If the enterprise project function is not enabled, the value is **0**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | fw_instance_id        | No        | String | Firewall ID, which can be obtained by referring to :ref:`Obtaining a Firewall ID <cfw_02_0028>`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   +-----------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                       |
   +==============+===========+========+===================================================================================================+
   | X-Auth-Token | Yes       | String | User token. You can obtain the token by referring to :ref:`Obtaining a User Token <cfw_02_0029>`. |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+
   | Content-Type | Yes       | String | Content type. It can only be set to application/json.                                             |
   +--------------+-----------+--------+---------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------+-------------------------------------------------------------------------+-------------------------------------------+
   | Parameter | Type                                                                    | Description                               |
   +===========+=========================================================================+===========================================+
   | data      | :ref:`VPCProtectsVo <listprotectedvpcs__response_vpcprotectsvo>` object | Return value for querying protected VPCs. |
   +-----------+-------------------------------------------------------------------------+-------------------------------------------+

.. _listprotectedvpcs__response_vpcprotectsvo:

.. table:: **Table 5** VPCProtectsVo

   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter          | Type                                                                                          | Description                                                                                                                                            |
   +====================+===============================================================================================+========================================================================================================================================================+
   | total              | Integer                                                                                       | Total number of protected VPCs.                                                                                                                        |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | self_total         | Integer                                                                                       | The firewall can protect VPCs across accounts. **self_total** indicates the total number of protected VPCs in the current project.                     |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | other_total        | Integer                                                                                       | The east-west firewall protection can protect VPCs across accounts. **other_total** indicates the number of protected VPCs in other projects.          |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protect_vpcs       | Array of :ref:`VpcAttachmentDetail <listprotectedvpcs__response_vpcattachmentdetail>` objects | The east-west firewall protection can protect VPCs across accounts. **protect_vpcs** indicates the list of all protected VPCs.                         |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | self_protect_vpcs  | Array of :ref:`VpcAttachmentDetail <listprotectedvpcs__response_vpcattachmentdetail>` objects | The east-west firewall protection can protect VPCs across accounts. **self_protect_vpcs** indicates the list of protected VPCs in the current project. |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | other_protect_vpcs | Array of :ref:`VpcAttachmentDetail <listprotectedvpcs__response_vpcattachmentdetail>` objects | The east-west firewall protection can protect VPCs across accounts. **other_protect_vpcs** indicates the list of protected VPCs of other projects.     |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+
   | total_assets       | Integer                                                                                       | Total number of VPC assets of a tenant.                                                                                                                |
   +--------------------+-----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listprotectedvpcs__response_vpcattachmentdetail:

.. table:: **Table 6** VpcAttachmentDetail

   ========= ====== =====================================================
   Parameter Type   Description
   ========= ====== =====================================================
   vpc_id    String ID of a protected VPC added for east-west protection.
   ========= ====== =====================================================

**Status code: 500**

.. table:: **Table 7** Response body parameters

   ========== ====== ==================
   Parameter  Type   Description
   ========== ====== ==================
   error_code String Error code.
   error_msg  String Error description.
   ========== ====== ==================

Example Requests
----------------

Query the east-west firewall protection information about the projected object with the ID 8839526e-b804-4a15-a082-a2c797dce633 in project 0b2179bbe180d3762fb0c01a2d5725c7.

.. code-block::

   https://{Endpoint}/v1/0b2179bbe180d3762fb0c01a2d5725c7/vpcs/protection?object_id=8839526e-b804-4a15-a082-a2c797dce633

Example Responses
-----------------

**Status code: 200**

Return value of east-west protection query.

.. code-block::

   {
     "data" : {
       "other_protect_vpcs" : [ ],
       "other_total" : 0,
       "protect_vpcs" : [ ],
       "self_protect_vpcs" : [ ],
       "self_total" : 0,
       "total" : 0,
       "total_assets" : 5
     }
   }

**Status code: 400**

Bad Request

.. code-block::

   {
     "error_code" : "CFW.00109004",
     "error_msg" : "HTTP request error."
   }

Status Codes
------------

=========== ===========================================
Status Code Description
=========== ===========================================
200         Return value of east-west protection query.
400         Bad Request
401         Unauthorized
403         Forbidden
404         Not Found
500         Internal Server Error
=========== ===========================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
